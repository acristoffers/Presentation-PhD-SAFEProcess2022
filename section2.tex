% !TeX root = document.tex
% !TeX encoding = UTF-8 Unicode

\subsection{Observer Design}%
\label{subsec:observer-design}

\begin{slide}{Bank of Observers}
  \input{imgs/schematic}
\end{slide}

\begin{slide}{Observer Design}
  \begin{columns}[c]
    \begin{column}{0.55\textwidth}
      \begin{equation}
        \begin{aligned}
          \textrm{arg min } & \norm{P}_{2}    \\
          \textrm{s.t. }    & \dot{V} \prec 0 \\
                            & P \succ 0,
        \end{aligned}
      \end{equation}
      %
      where
      %
      \begin{align}
        \dot{V} \equiv & \begin{bmatrix}
                           X        & W  \\
                           W^{\top} & -I
                         \end{bmatrix},                                         \\
        \lambda\in     & \mathbb{R}^{+} \textrm{ is a free constant}, \nonumber \\
        P              & \textrm{ is a semidefinite positve matrix} \nonumber
      \end{align}
      %
      with
      %
      \begin{align}
        \begin{split}
          X = & \hat{A}^{\top}F^{\top}P - \hat{A}^{\top}C^{\top}\hat{E}^{\top} -                 \\
              & \hat{C}^{\top}\hat{K}^{\top} + PF\hat{A} - \hat{E}C\hat{A} - \hat{K}\hat{C} - \lambda{}I,
        \end{split} \\
        W = & \sqrt{\lambda}(PF - \hat{E}C).
      \end{align}
    \end{column}%
    \hfill%
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          \hat{A} & = AF^{+},               \\
          \hat{C} & = CF^{+},               \\
          \hat{E} & = P\mE = PU + \hat{Y}V, \\
          \hat{K} & = PK,                   \\
          \hat{Y} & = PY.
        \end{split} \\\nonumber\\
        \begin{split}
          K   & = P^{-1}\hat{K},  \\
          Y   & = P^{-1}\hat{Y},  \\
          \mE & = U + YV,         \\
          R   & = F - \mE{}C,     \\
          \mN & = (RA - KC)F^{+}, \\
          \mJ & = K + N\mE{},     \\
          \mH & = RB.
        \end{split}
      \end{align}
    \end{column}%
  \end{columns}
\end{slide}

\begin{slide}{Observer Design Development}
  \begin{columns}[c]
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          e & = \hat{z} - z   \\
            & = w + \mE{}y - Fx   \\
            & = w + \mE{}Cx - Fx.
        \end{split} \\
        \begin{split}
          \dot{e} & = \dot{w} + (\mE{}C-F)\dot{x}              \\
                  & = \mN{}w + \mJ{}y + \mH{}u + (\mE{}C-F)(Ax + Bu + Lf)  \\
                  & = \mN{}e + (\mN{}F-\mN{}\mE{}C+\mE{}CA-FA+\mJ{}C)x +           \\
                  & \phantom{=~} (\mH{}+\mE{}CB-FB)u + (\mE{}CL-FL)f.
        \end{split}
      \end{align}
    \end{column}%
    \hfill%
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          \mN{} \textrm{ must be Hurwitz-stable}, &      \\
          \mN{}(F-\mE{}C)-(F-\mE{}C)A+\mJ{}C      & = 0, \\
          \mH{}-(F-\mE{}C)B                       & = 0.
        \end{split} \\\nonumber\\
        \begin{split}
          (F-\mE{}C)L_{i} & = 0,     \\
          (F-\mE{}C)L_{n} & \neq 0.
        \end{split}
      \end{align}
    \end{column}%
  \end{columns}
\end{slide}

\begin{slide}{Observer Design Development}
  \begin{columns}[c]
    \begin{column}{0.55\textwidth}
      \begin{align}
        V             & = e^{\top}Pe,              \\
        \dot{e}       & = \mN{}e-(F-\mE{}C)L_{n}f, \\
        e             & \propto L_{n}f,            \\
        \norm{L_{n}f} & = \lambda{}\norm{e},       \\
        R             & = F-\mE{}C,                \\
        \dot{e}       & = \mN{}e-R\lambda\norm{e}.
      \end{align}
    \end{column}%
    \hfill%
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          \dot{V} & = \dot{e}^{\top}Pe + e^{\top}P\dot{e}                                             \\
                  & = (\mN{}e-\lambda{}R\norm{e})^{\top}Pe + e^{\top}P(\mN{}e-\lambda{}R\norm{e})     \\
                  & = e^{T}(\mN{}^{\top}P + P\mN{})e - 2\lambda\norm{e^{\top}PR}\cdot\norm{e}         \\
                  & \leq e^{T}(\mN{}^{\top}P + P\mN{})e - \lambda(\norm{e^{\top}PR}^{2}+\norm{e}^{2}) \\
                  & = e^{T}(\mN{}^{\top}P + P\mN{} - \lambda{}PRR^{\top}P - \lambda{}I)e.
        \end{split}
      \end{align}
    \end{column}%
  \end{columns}
\end{slide}

\begin{slide}{Observer Design Development}
  \begin{columns}[c]
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          \mN{}(F-\mE{}C) & = RA-\mJ{}C,              \\
          \mN{}F          & = RA-(\mJ{}-\mN{}\mE{})C, \\
          K               & = \mJ{}-\mN{}\mE{},       \\
          \mN{}           & = RAF^{+}-KCF^{+},
        \end{split} \\
        \begin{split}
          (F-\mE{}C)L_{i} & = 0,                                              \\
          \mE{}CL_{i}     & = FL_{i},                                         \\
          \mE{}           & = FL_{i}(CL_{i})^{+} + Y(I-(CL_{i})(CL_{i})^{+}), \\
          U               & = \mE{}CL_{i}L_{i}^{+},                           \\
          V               & = I-L_{i}L_{i}^{+},                               \\
          \mE{}           & = U+YV.
        \end{split}
      \end{align}
    \end{column}%
    \hfill%
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          \dot{V} & = e^{T}((R\hat{A} - \mE{}C\hat{A} - K\hat{C})^{\top}P +                                     \\
                  & P(R\hat{A} - \mE{}C\hat{A} - K\hat{C}) - \lambda{}PRR^{\top}P - \lambda{}I)e.               \\
                  & = \hat{A}^{\top}F^{\top}P - \hat{A}^{\top}C^{\top}\hat{E}^{\top} - \hat{C}^{\top}K^{\top} + \\
                  & PF\hat{A} - \hat{E}C\hat{A} - K\hat{C} - \lambda{}PRR^{\top}P - \lambda{}I.
        \end{split}
      \end{align}
    \end{column}%
  \end{columns}
\end{slide}

\begin{slide}{Residual Generator}
  \begin{columns}[c]
    \begin{column}{0.55\textwidth}
      \begin{align}
        r(t) & = Gw(t) + My(t), \\
        \begin{split}
          M & = (C(1-L_{i}))^{\top},      \\
          G & = -M(I-CF^{+}\mE{})^{-1}CF^{+},
        \end{split}
      \end{align}
    \end{column}%
    \hfill%
    \begin{column}{0.55\textwidth}
      \begin{align}
        \begin{split}
          r & = Gw + My                          \\
            & = Q(y - Cx)                        \\
            & = Q(y - CF^{-1}\hat{z})            \\
            & = Q(y - CF^{-1}(w+\mE{}y))         \\
            & = Q((I-CF^{-1}\mE{})y - CF^{-1}w),
        \end{split} \\
        \begin{split}
          M & = Q(I-CF^{-1}\mE{}), \\
          G & = -QCF^{-1}.
        \end{split}
      \end{align}
    \end{column}%
  \end{columns}
\end{slide}
